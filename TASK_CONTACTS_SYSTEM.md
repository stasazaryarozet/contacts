# ЗАДАЧА: Система управления контактами

**Дата создания**: 2025-10-29  
**Статус**: Требует редизайна (философия Gemini)  
**Приоритет**: Критический  
**Владелец**: AI Developer (новый)

---

## ⚠️ КРИТИЧЕСКОЕ ЗАМЕЧАНИЕ ОТ КООРДИНАТОРА (GEMINI)

**Получено**: 2025-10-29 19:20

> "CRM — это не программное обеспечение. Это процесс запоминания релевантной информации о контакте для достижения конкретной цели в будущем. Максимальный результат — достижение этой цели. Минимальное усилие — сбор и обработка только той информации, которая прямо ведет к этой цели."

### Философия минимума (Gemini):

**Принципы**:
1. **Цель первична**: Определить ОДНУ конкретную цель (не "улучшить маркетинг", а "отправлять 1 релевантное письмо в месяц")
2. **MVD (Minimum Viable Data)**: 3-5 полей МАКСИМУМ
3. **GIGO**: Не собирать мусор (поля, которые не используются)
4. **Парето 80/20**: Фокус на 20% ценных контактов
5. **Действие > Хранение**: Список должен использоваться ЕЖЕДНЕВНО
6. **Безжалостная чистка**: Мертвые контакты → удалить

**Пример MVD** (от Gemini):
```
Цель: Регулярно контактировать с партнерами
Поля: 
  A: Имя
  B: Компания
  C: Контакт (Email/TG)
  D: О_чем_последний_раз_говорили
  E: Дата_след_контакта
```
Всё. 5 полей. Остальное — шум.

### Текущая система (ПРОБЛЕМЫ):

❌ **Нет четкой ЦЕЛИ** → Зачем список? Для чего именно?  
❌ **7 полей** (Email, Name, Phone, Source, Tag, Notes, DateAdded) → Gemini требует **3-5 максимум**  
❌ **Нет "Дата_след_контакта"** → Нет действия, нет использования  
❌ **Нет "О_чем_последний_раз_говорили"** → Нет контекста отношений  
❌ **"Source"** → Мусор для большинства целей  
❌ **"Tag"** → Без связи с целью (что это дает для действия?)

**Вывод**: Система построена БЕЗ определения цели. Избыточна. Не соответствует философии q1.

---

## ПЕРВАЯ ЗАДАЧА ДЛЯ НОВОГО РАЗРАБОТЧИКА

### ⚠️ КРИТИЧЕСКИЙ ПРИОРИТЕТ 0: Определить ЦЕЛЬ

**Задача**: Спросить у User/Ольги: **"Зачем нужен список адресатов? Какое одно конкретное действие будет с ним совершаться регулярно?"**

**Примеры целей**:
- "Отправлять email-рассылку с новостями тура 1 раз в месяц"
- "Звонить потенциальным участникам раз в неделю"
- "Помнить, кому из VIP нужно отправить персональное приглашение"
- "Не забывать даты следующего контакта с каждым партнером"

**Критерий выполнения**: Одна конкретная, измеримая цель зафиксирована.

**После определения цели**:
1. Редуцировать поля до MVD (3-5 полей, прямо связанных с целью)
2. Переписать архитектуру
3. Упростить UI
4. Обновить документацию

---

## КОНТЕКСТ ПРОЕКТА

**Проект**: Paris-2026 — кураторский тур в Париж (январь 2026)  
**Сайт**: https://parisinjanuary.ru  
**Репозиторий**: https://github.com/stasazaryarozet/paris-2026

**Операционная модель**: `OPERATIONAL_MODEL_PROPOSAL_v7.md`  
**Ключевые принципы**:
- **q0 (Забота о Создателе)**: Человек делает только творчество
- **q1 (Можно ли без этого обойтись?)**: Минимум компонентов
- **Нулевой бюджет**: Только бесплатные решения
- **Абсолютная автономность**: Принимать решения самостоятельно
- **Постоянная чистка**: Удалять неиспользуемое немедленно

---

## ЗАДАЧА ОТ КООРДИНАТОРА (GEMINI)

> "Создать «Список Адресатов» Ольги. Реализовать в соответствии с q0 и q1. Архитектура (Вечное): ADDRESS_LIST.csv как единый источник правды. Архитектура (Временное): UI для тегирования. Задача AI: выполнить всю техническую работу. Задача человека (Ольга): творчество (тегирование контактов)."

**Зачем**: Ольга (куратор проекта) должна иметь централизованный список всех контактов (участники, VIP, партнеры, студенты) для email-рассылок и коммуникации.

---

## ТЕКУЩИЙ СТАТУС (29.10.2025)

### ✅ Выполнено

**1. Инфраструктура создана:**
- `ADDRESS_LIST.csv` (45 B) — единый источник правды
- `tools/manage_contacts.py` (14 KB) — импорт, слияние, дедупликация
- `tools/create_tagging_ui.py` (11 KB) — генерация HTML UI
- `tagging_ui.html` (9.6 KB) — локальный UI для тегирования
- Документация: `ADDRESS_LIST_SETUP.md`, `ADDRESS_LIST_QUICKSTART.md`, `ADDRESS_LIST_COMPLETE.md`

**2. Архитектурные решения:**
- **Primary Key**: Email (приоритет) OR Phone (альтернатива)
- **Дедупликация**: По ключу `email:{email}` или `phone:{phone}`
- **UI**: Локальный HTML (без облака, без Google Sheets)
- **Автосохранение**: localStorage браузера
- **Экспорт**: CSV одной кнопкой

**3. Импортировано контактов:**
- Источник: "Сентябрь 2025 Лиды" (`Сентябрь 2025 Лиды - Sheet1.csv`)
- Всего: 18 контактов
  - 3 с email
  - 15 только с телефоном

### ❌ Не выполнено / Требует доработки

**1. Импорт исторических источников:**
- ❌ Gmail экспорт (контакты Ольги)
- ❌ iPhone контакты (vCard экспорт)
- ❌ Прошлые туры (если есть списки участников)
- ❌ Website Forms (`server/submissions.log` — пока пустой)

**2. Функциональность:**
- ❌ Обратная синхронизация: После тегирования в UI → обновление `ADDRESS_LIST.csv`
- ❌ Валидация номеров телефонов (международный формат)
- ❌ Проверка email на существование (опционально)
- ❌ Экспорт сегментированных списков (по тегам)

**3. Интеграция:**
- ❌ Email-рассылки (Mailchimp/Sendinblue интеграция или скрипт)
- ❌ Синхронизация с формой на сайте (автоматическое добавление новых заявок)

---

## АРХИТЕКТУРА СИСТЕМЫ

```
┌─────────────────────────────────────────────────────────┐
│          ИСТОЧНИКИ КОНТАКТОВ (входящие)                 │
├─────────────────────────────────────────────────────────┤
│  • Gmail CSV экспорт                                    │
│  • iPhone vCard (.vcf)                                  │
│  • Website Forms (server/submissions.log)               │
│  • Прошлые туры (CSV/Excel)                            │
│  • Сентябрь 2025 Лиды (CSV) ✓                          │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│              АВТОМАТИЗАЦИЯ (AI)                         │
│           tools/manage_contacts.py                      │
├─────────────────────────────────────────────────────────┤
│  • Импорт из всех источников                           │
│  • Нормализация (email lowercase, phone +7...)         │
│  • Дедупликация по ключу (email:... / phone:...)       │
│  • Обновление пустых полей при слиянии                 │
│  • Сохранение в ADDRESS_LIST.csv                       │
│  • Экспорт для UI (ADDRESS_LIST_FOR_GSHEET.csv)        │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│          ЕДИНЫЙ ИСТОЧНИК ПРАВДЫ (вечный)                │
│                ADDRESS_LIST.csv                         │
├─────────────────────────────────────────────────────────┤
│  Поля: Email, Name, Phone, Source, Tag, Notes,         │
│         DateAdded                                       │
│  Primary Key: Email OR Phone                            │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│            ГЕНЕРАЦИЯ UI (AI)                            │
│         tools/create_tagging_ui.py                      │
├─────────────────────────────────────────────────────────┤
│  • Читает ADDRESS_LIST_FOR_GSHEET.csv                  │
│  • Генерирует tagging_ui.html                          │
│  • Встраивает данные как JSON                          │
│  • Автоматически открывает в браузере                  │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│       ЛОКАЛЬНЫЙ UI (без облака, временный)              │
│              tagging_ui.html                            │
├─────────────────────────────────────────────────────────┤
│  • Таблица с контактами                                │
│  • Dropdown для тегов (VIP/Коллега/Студент/...)        │
│  • Поле для заметок                                    │
│  • Автосохранение в localStorage                       │
│  • Кнопка "Экспортировать CSV"                         │
│  • Статистика (всего/с тегами/без тегов)              │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│         ТВОРЧЕСКАЯ РАБОТА (Ольга)                       │
│            Тегирование контактов                        │
├─────────────────────────────────────────────────────────┤
│  1. Открыть tagging_ui.html в браузере                 │
│  2. Выбрать тег для каждого контакта                   │
│  3. Добавить заметки (опционально)                     │
│  4. Нажать "Экспортировать CSV"                        │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│           ЭКСПОРТ И СОХРАНЕНИЕ                          │
│        ADDRESS_LIST_TAGGED.csv                          │
├─────────────────────────────────────────────────────────┤
│  • Скачивается из браузера                             │
│  • Копируется обратно в ADDRESS_LIST.csv               │
│  • Готов к использованию для рассылок                  │
└─────────────────────────────────────────────────────────┘
```

---

## СТРУКТУРА ФАЙЛОВ

### Основные файлы

```
ADDRESS_LIST.csv                      # Единый источник правды (45 B)
ADDRESS_LIST_FOR_GSHEET.csv           # Подготовленные данные для UI
tagging_ui.html                       # UI для тегирования (9.6 KB)
Сентябрь 2025 Лиды - Sheet1.csv      # Исходные данные (не удалять)
```

### Скрипты (tools/)

```
tools/manage_contacts.py              # Импорт, слияние, дедупликация (14 KB)
tools/create_tagging_ui.py            # Генерация HTML UI (11 KB)
```

### Документация

```
ADDRESS_LIST_SETUP.md                 # Полная документация (7.9 KB)
ADDRESS_LIST_QUICKSTART.md            # Быстрый старт (3.8 KB)
ADDRESS_LIST_COMPLETE.md              # Итоговый отчет (12 KB)
```

### Структура ADDRESS_LIST.csv

```csv
Email,Name,Phone,Source,Tag,Notes,DateAdded
m.v.khaustova@gmail.com,Марина Хаустова,,Сентябрь 2025,,ПОЛУЧЕНИЕ ВИЗЫ,2025-10-29
,Голованец Людмила,+78985446168,Сентябрь 2025,,РЕШЕНИЕ ВОПР ОТПУСКА,2025-10-29
```

**Поля**:
- `Email` — email контакта (может быть пустым если есть Phone)
- `Name` — имя контакта
- `Phone` — телефон в международном формате (+7...)
- `Source` — источник контакта (может быть несколько через запятую)
- `Tag` — категория (VIP/Коллега/Студент/Прошлый тур/Партнёр)
- `Notes` — заметки
- `DateAdded` — дата добавления (YYYY-MM-DD)

**Primary Key**: Email OR Phone (приоритет Email)

---

## ЗАДАЧИ ДЛЯ НОВОГО РАЗРАБОТЧИКА

### Приоритет 1: Импорт всех источников

**Задача**: Получить и импортировать все доступные контакты

**Источники для импорта**:
1. **Gmail экспорт Ольги**
   - Запросить у User экспорт: Gmail → Контакты → Экспорт → Google CSV
   - Импортировать через `manager.import_gmail_csv("gmail.csv", "Gmail")`

2. **iPhone контакты Ольги**
   - Запросить у User экспорт: iCloud → Контакты → Экспорт vCard
   - Импортировать через `manager.import_vcf("iphone.vcf", "iPhone")`

3. **Прошлые туры** (если есть списки участников)
   - Запросить у User CSV/Excel с участниками прошлых туров
   - Импортировать через `manager.import_gmail_csv("past_tours.csv", "Прошлый тур 2024")`

4. **Website Forms** (автоматически, когда появятся заявки)
   - Проверять `server/submissions.log`
   - Автоматический импорт через `manager.import_form_submissions()`

**Код для импорта**:
```python
cd "/Users/azaryarozet/Library/Mobile Documents/com~apple~CloudDocs/Projects/paris-2026"
python3 tools/manage_contacts.py
```

**Критерий выполнения**: В `ADDRESS_LIST.csv` импортированы все доступные контакты из всех источников.

---

### Приоритет 2: Автоматическая синхронизация

**Задача**: Автоматизировать обновление ADDRESS_LIST.csv после тегирования

**Проблема**: Сейчас после тегирования в UI нужно вручную:
1. Скачать CSV из браузера
2. Скопировать в `ADDRESS_LIST.csv`

**Решение**: Создать скрипт для обратной синхронизации

**Код** (`tools/sync_tagged_contacts.py`):
```python
#!/usr/bin/env python3
"""
Синхронизация тегированных контактов обратно в ADDRESS_LIST.csv
"""
import csv
from pathlib import Path

project_root = Path(__file__).parent.parent
tagged_csv = project_root / "Downloads" / "ADDRESS_LIST_TAGGED.csv"  # или другой путь
address_list = project_root / "ADDRESS_LIST.csv"

# Прочитать тегированные контакты
# Обновить теги и заметки в ADDRESS_LIST.csv
# Сохранить обратно

print("✓ Синхронизация завершена")
```

**Критерий выполнения**: После тегирования достаточно запустить `python3 tools/sync_tagged_contacts.py`, и все изменения автоматически применятся.

---

### Приоритет 3: Email-рассылки

**Задача**: Подготовить систему для email-рассылок по сегментам

**Требования**:
1. Экспорт списков по тегам (VIP, Коллеги, Студенты отдельно)
2. Формат для импорта в Mailchimp/Sendinblue (CSV с Email, Name)
3. Валидация email перед экспортом

**Код** (`tools/export_by_tag.py`):
```python
#!/usr/bin/env python3
"""
Экспорт контактов по тегам для email-рассылок
"""
import csv
from pathlib import Path

# Функция: export_by_tag(tag: str) -> CSV файл
# Пример: export_by_tag("VIP") → VIP_contacts.csv

# Формат: Email, Name (совместим с Mailchimp)
```

**Критерий выполнения**: Команда `python3 tools/export_by_tag.py VIP` создаёт `VIP_contacts.csv` с валидными email.

---

### Приоритет 4: Валидация и очистка

**Задача**: Проверить качество данных

**Проверки**:
1. Валидация email (формат + существование домена)
2. Нормализация телефонов (все в формате +7...)
3. Удаление дубликатов (разные написания одного человека)
4. Проверка пустых полей (Name обязателен)

**Код** (добавить в `manage_contacts.py`):
```python
def validate_contacts(self):
    """Валидация всех контактов"""
    issues = []
    for key, contact in self.contacts.items():
        if not contact.name:
            issues.append(f"Пустое имя: {contact.email or contact.phone}")
        if contact.email and not self.is_valid_email(contact.email):
            issues.append(f"Невалидный email: {contact.email}")
    return issues
```

**Критерий выполнения**: Все контакты имеют валидные данные, нет очевидных дубликатов.

---

## ПРИНЦИПЫ РАБОТЫ (обязательны к соблюдению)

Прочитай внимательно: `OPERATIONAL_MODEL_PROPOSAL_v7.md`

**Краткая выжимка**:

1. **q0 (Забота о Создателе)**
   - Ольга делает ТОЛЬКО творчество (выбор тегов)
   - Вся техническая работа автоматизирована

2. **q1 (Можно ли без этого обойтись?)**
   - Перед добавлением нового компонента: МОЖНО ЛИ БЕЗ НЕГО?
   - Если можно — не добавляем

3. **Нулевой бюджет**
   - Только бесплатные решения
   - Отказ от Google Cloud → локальный HTML UI

4. **Абсолютная автономность**
   - Принимать все технические решения самостоятельно
   - Не спрашивать разрешений
   - Информировать о действиях

5. **Постоянная чистка**
   - Удалять неиспользуемые артефакты немедленно
   - Мёртвый код → удалить

6. **Автоматизация**
   - Человек делает только творчество
   - Всё остальное → автоматизировать

---

## КОММУНИКАЦИЯ С ДРУГИМИ AI

**Файл для координации**: `AI_COMMUNICATION_LOG.md`

**Формат записи**:
```markdown
## YYYY-MM-DD · Название задачи

Авторы: [Твой ID] → [Другой AI]

**Что сделано:**
- ...

**Статус:** ...
```

**При передаче задачи другому AI**:
- Обновить `AI_COMMUNICATION_LOG.md`
- Зафиксировать в `reasoning.log`
- Указать текущий статус и следующие шаги

---

## ТЕКУЩИЕ ПРОБЛЕМЫ

1. **Мало контактов**: Сейчас только 18 из сентябрьской кампании
   - Нужны экспорты от Ольги (Gmail, iPhone)

2. **Ручная синхронизация**: После тегирования нужно вручную копировать CSV
   - Требуется автоматизация

3. **Нет интеграции с формой**: Новые заявки на сайте не попадают автоматически в систему
   - `server/submissions.log` пока пустой
   - Требуется настройка формы или периодический импорт

---

## КРИТЕРИИ УСПЕХА

**Минимальный MVP** (должно работать):
- ✅ Импортированы все доступные контакты (100+)
- ✅ UI для тегирования функционирует
- ✅ Ольга может тегировать контакты за 5 минут
- ✅ Экспорт CSV работает

**Полная версия** (идеально):
- ✅ Автоматическая синхронизация после тегирования
- ✅ Экспорт по тегам для email-рассылок
- ✅ Валидация данных
- ✅ Интеграция с формой на сайте (автоматический импорт новых заявок)

---

## ПОЛЕЗНЫЕ КОМАНДЫ

### Импорт контактов
```bash
cd "/Users/azaryarozet/Library/Mobile Documents/com~apple~CloudDocs/Projects/paris-2026"
python3 tools/manage_contacts.py
```

### Создание UI
```bash
python3 tools/create_tagging_ui.py
open tagging_ui.html
```

### Проверка статуса
```bash
wc -l ADDRESS_LIST.csv  # Количество контактов
```

### Экспорт для Ольги
```bash
# UI уже открыт в браузере
# После тегирования → "Экспортировать CSV"
```

---

## КОНТАКТЫ

**User (владелец проекта)**: azaryarozet  
**Куратор (Ольга)**: o.g.rozet@gmail.com  
**Координатор (Gemini)**: через User  
**Предыдущий разработчик (Claude)**: Tactical Pilot

---

## ИСТОРИЯ ИЗМЕНЕНИЙ

| Дата | Событие | Автор |
|------|---------|-------|
| 2025-10-29 | Создание системы | Claude (Tactical Pilot) |
| 2025-10-29 | Отказ от Google Cloud | Claude |
| 2025-10-29 | Локальный HTML UI | Claude |
| 2025-10-29 | Импорт сентябрьских лидов (18) | Claude |
| 2025-10-29 | Поддержка Phone как Primary Key | Claude |
| 2025-10-29 | Передача новому разработчику | Claude |

---

## СЛЕДУЮЩИЕ ШАГИ (для нового AI)

1. Прочитать `OPERATIONAL_MODEL_PROPOSAL_v7.md` полностью
2. Ознакомиться с кодом: `tools/manage_contacts.py`, `tools/create_tagging_ui.py`
3. Запросить у User экспорты: Gmail, iPhone, прошлые туры
4. Импортировать все контакты
5. Обновить `AI_COMMUNICATION_LOG.md` со своим статусом
6. Реализовать Приоритет 2: Автоматическая синхронизация
7. Реализовать Приоритет 3: Email-рассылки

---

**Создано**: 2025-10-29  
**Автор**: Claude (Tactical Pilot)  
**Для**: Новый AI-разработчик  
**Статус**: Готово к передаче





